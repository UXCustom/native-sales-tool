doctype html
html(lang='en', dir='ltr')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge,chrome=1')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    title TechTarget
    //if lte IE 7
      script(src='http://cdn.ttgtmedia.com/microsites/ttgtShell/js/libs/icomoon_ie7.js')
    script(type='text/javascript', src='http://fast.fonts.net/jsapi/124d48dd-e515-4302-8bfb-1d5c1e3da916.js')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/normalize.css')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/icomoon.css')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/jquery.jscrollpane.css')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/jquery-ui-1.10.3.custom.min.css')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/responsive-carousel.css')
    link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/libs/responsive-carousel.slide.css')
    link(rel='stylesheet', href='http://media.eng.ttgtmedia.com/rms/ux/responsive/css/main.css?v=6.32-SNAPSHOT')
    //if lte IE 7
      link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/ie7.css')
    //if IE 8
      link(rel='stylesheet', href='http://cdn.ttgtmedia.com/microsites/ttgtShell/css/ie8.css')
    script(src='http://cdn.ttgtmedia.com/microsites/ttgtShell/js/libs/respond.min.js', type='text/javascript')
    script(type='text/javascript', src='http://cdn.ttgtmedia.com/microsites/ttgtShell/js/libs/modernizr.custom.50545.js')
    script(src='http://cdn.ttgtmedia.com/microsites/ttgtShell/js/libs/jquery-1.10.1.min.js')
    link(rel='shortcut icon', type='image/x-icon', href='/favicon.ico')
    link(rel='apple-touch-icon', sizes='144×144', href='/apple-touch-icon-144x144.png')
    link(rel='apple-touch-icon', sizes='114×114', href='/apple-touch-icon-114x114.png')
    link(rel='apple-touch-icon', sizes='72×72', href='/apple-touch-icon-72x72.png')
    link(rel='apple-touch-icon', href='/apple-touch-icon-precomposed.png')
    link(rel='apple-touch-icon-precomposed', sizes='144×144', href='/apple-touch-icon-144x144-precomposed.png')
    link(rel='apple-touch-icon-precomposed', sizes='114×114', href='/apple-touch-icon-114x114-precomposed.png')
    link(rel='apple-touch-icon-precomposed', sizes='72×72', href='/apple-touch-icon-72x72-precomposed.png')
    link(rel='apple-touch-icon-precomposed', href='/apple-touch-icon-precomposed.png')
    link(rel='stylesheet', href='css/style-responsive.css', type='text/css', media='screen')
    script(src='//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js')
    // Begin Google Tag Manager
    noscript
      iframe(src='//www.googletagmanager.com/ns.html?id=GTM-PWWZSH', height='0', width='0', style='display:none;visibility:hidden')
    script.
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PWWZSH');
    noscript
      iframe(src='//www.googletagmanager.com/ns.html?id=GTM-5CSF7N', height='0', width='0', style='display:none;visibility:hidden')
    script.
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5CSF7N');
    // End Google Tag Manager
    script(src='javascript/jgestures.min.js')
    script(src='javascript/script-responsive.js')
    script(src='javascript/video.js')
    script(src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.js")
    script(type="text/javascript" src="javascript/jspdf.min.js")
    script(type="text/javascript" src="javascript/html2canvas.js")
    link(rel="stylesheet", type="text/css", href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.css")
    style.
      #editWindow {
        background: #333;
        bottom: -10%;
        border-radius: 5px 5px  0 0;
        color: #fff;
        display: block;
        font: 13px/1.8 Monaco, Mono-Space;
        height: auto;
        left: 50%;
        margin-left: -175px;
        padding: 20px;
        position: fixed;
        //- top: 300px;
        width: 350px;
        z-index: 9999;
      }
      #editWindow.open { bottom: 0;}
      body style, body > #micrositeWrapper > #editWindow > script {
        display: block;
        overflow-x: scroll;
        white-space: pre;
      }
      #editWindow > div {
        float: left;
        text-align: center;
        width: 50%;
      }
      #editWindow > div > p {
        color: #fff;
        margin-bottom: 10px;
      }
      .pull {
        background: #333;
        border-radius: 5px 5px  0 0;
        color: #fff;
        cursor: pointer;
        display: block;
        float: none;
        font-size: 20px;
        left: 50%;
        line-height: 1;
        margin: 0 0 0 -20px;
        position: absolute;
        text-align: center;
        top: -23px;
        width: 40px !important;
      }
      
      .pull p {margin: 0 !important;}
      #homepage #additionalResources {
        display: none;
      }
  body
    #editWindow
      .pull
        p ↓
      #editWindowLeft
        .c1
          p Client Color 1
          input.one(type="color", id="html5colorpicker", style="width:100%;")
        .c2
          p Client Color 2
          input.two(type="color", id="html5colorpicker", style="width:100%;")
      #editWindowRight
        p Layout Change
        select#layoutChoice
          option(value="A", selected="selected") A: Addtional Downloads
          option(value="B") B: Latest Resources
        p Title Change
        input#changeTitle
        button.generate-pdf(onclick="javascript:generatePDF();")
          div Generate PDF
    script(contenteditable).
      $('.pull').on('click', function() {
        $('#editWindow').toggleClass('open');
      });
      $(".one, .two").spectrum({
          allowEmpty:true,
          color: "#ECC",
          showInput: true,
          containerClassName: "full-spectrum",
          showInitial: true,
          showPalette: true,
          showSelectionPalette: true,
          //- showAlpha: true,
          maxPaletteSize: 10,
          preferredFormat: "hex",
          localStorageKey: "spectrum.demo"
      });
      
      $('#changeTitle').on('input',function() {
        $('.siteTitle').text($(this).val());
        if ($(this).val() == '') {
          $('.siteTitle').text('Productivity and Collaboration');  
        }
      });
      $('#layoutChoice').on('change', function() {
        if ($('#layoutChoice option:selected').val() == 'A') {
          $('#homepage #additionalResources').css('display','none');
          $('#homepage #additionalDownloads, #resources').css('display','block');
        } else {
          $('#homepage #additionalDownloads, #resources').css('display','none');
          $('#homepage #additionalResources').css('display','block');
        }
      });
      $( ".one" ).on('change', function() {
          var value = $( this ).val();
          $('#articleNavigation, .heroPrimary .heroPrimaryTarget:hover p, #featuredItems ul li a:hover .cta, #homepage #additionalResources #additionalResourcesContainer #latestVideo a#launchModal:hover picture:before, .heroSecondary .productIndicator').css({
            'background-color': $('#html5colorpicker').val()
          });
          $('.heroPrimary p, #featuredItems ul li a .cta').css({
            'border-color': $('#html5colorpicker').val()
          });
          $('.heroPrimary p, #featuredItems ul li a .cta, #featuredItems ul li p span.time, #homepage #additionalResources #additionalResourcesContainer #latestArticles ul li span.cta, #homepage #additionalResources #additionalResourcesContainer #latestDownloads ul li i.icon-download-arrow, #homepage #additionalResources #additionalResourcesContainer #latestDownloads ul li span.cta, #homepage #additionalResources #additionalResourcesContainer #latestArticles a.viewAll i, #homepage #additionalResources #additionalResourcesContainer #latestDownloads a.viewAll i, #homepage #additionalResources #additionalResourcesContainer #latestVideo a.viewAll i, #articleNavigation ul#articleMainNav > li ul > li > a i, body.socialMenuOpen #articleHeader #articleHeadline a.socialButton, nav#articleSocialNav .share-bar-container li a:hover, body.socialMenuOpen #articleSocialNav .share-bar-container li a:hover, #homepage #additionalResources #additionalResourcesContainer #latestArticles ul li a:hover span.title, #homepage #additionalResources #additionalResourcesContainer #latestDownloads ul li a:hover span.title').css({
            'color': $('#html5colorpicker').val()
          });
          $('#articleNavigation ul#articleMainNav > li ul > li > a:hover, #articleNavigation ul#articleResourcesNav > li ul > li > a:hover, #articleNavigation ul#articleResourcesNav > li:first-child ul > li > a:hover').css({
            'border-left-color': $('#html5colorpicker').val()
          });
        });
      $( ".two" ).on('change', function() {
          var value = $( this ).val();
          $('.heroSecondary h3, .heroPrimary h3').css({
            'border-bottom-color': $('.two').val()
          });
          $('#featuredItems ul li .thumbnail, #homepage #additionalResources #additionalResourcesContainer #latestArticles h6, #homepage #additionalResources #additionalResourcesContainer #latestDownloads h6, #homepage #additionalResources #additionalResourcesContainer #latestVideo h6').css({
            'border-top-color': $('.two').val()
          });
        });

    script(generatePDF).
      function generatePDF() {
        $('#editWindow').hide();
        html2canvas($("body"), {
          onrendered: function (canvas) {
            var imgData = canvas.toDataURL('image/jpg');
            var imgWidth = 210;
            var pageHeight = 295;
            var imgHeight = canvas.height * imgWidth / canvas.width;
            var heightLeft = imgHeight;

            var doc = new jsPDF('p', 'mm');
            var position = 0;

            doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft >= 0) {
              position = heightLeft - imgHeight;
              doc.addPage();
              doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
              heightLeft -= pageHeight;
            }
            doc.save('TechTarget-StandAloneSite.pdf')
            $('#editWindow').show();
          }
        });
      }
    #micrositeWrapper
      include pageSections/header
      include pageSections/navigation
      include pageSections/homeContent
      include pageSections/resourcesSection
      #videoModal
        #videoModalPlayerContainer
      include pageSections/footer
    script(src="javascript/jquery.menu-aim.js")
    script(src="//players.brightcove.net/1660622130/SJJxTCbc_default/index.min.js")
    script(src="http://cdn.ttgtmedia.com/rms/ux/javascript/microsite/videojs.ga.videocloud.js")
